kNearestNeigboors <- function(x, k, s) {
x.dis <- sqrt((s - x)^2)
s.ind <- which(x.dis %in% sort(x.dis)[1:k])
s.wgh <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x.new <- sample(s[s.ind], size = 1, replace = TRUE, prob = s.wgh)
x.new.ind <- which(x.new == s)
return(x.new.ind)
}
x <- 50
y <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
x <- 50
y <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k <- 5
x <- 50
s <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k <- 5
x.dis <- sqrt((s - x)^2)
x.dis
dist <- sqrt((s - x)^2)
dist
x_dist <- sqrt((s - x)^2)
s_index <- order(x_dist)[1:k]
s_index
# Distance to each data-point
x_dist <- sqrt((s - x)^2)
# Indices of k-nearest data-points
s_index <- order(x_dist)[1:k]
s_index
# Indices of k-nearest data-points
s_knearest <- order(x_dist)[1:k]
# Indices of k-nearest data-points
s_near <- order(x_dist)[1:k]
sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
sum(s.wgh)
s.wgh  <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
sum(s.wgh)
# Indices of k-nearest data-points
s_near <- order(x_dist)[1:k]
s_near
# Indices of k-nearest data-points
s_near <- s[order(x_dist)[1:k]]
s_near
# Indices of k-nearest data-points
kn <- s[order(x_dist)[1:k]]
kn_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
# Indices of k-nearest data-points
kn <- s[order(x_dist)[1:k]]
kn
kn_wgt
new <- sample(kn, size = 1, replace = TRUE, prob = s.wgh)
new
x_new <- sample(kn, size = 1, replace = TRUE, prob = s.wgh)
x_new
kn
kn_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
# Indices of k-nearest data-points
kn <- order(x_dist)[1:k]]
# Indices of k-nearest data-points
kn <- order(x_dist)[1:k]
kn
# Indices of k-nearest data-points
s_kn  <- order(x_dist)[1:k]
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
out
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 21, 1, 34)
k1 <- 5
kNearestNeigboors <- function(x, k, s) {
x_dist <- sqrt((s - x)^2)
s_wgt <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
return(x_new)
}
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
s1[out]
res <- vector(mode = "numeric", length = 100)
for(i in 1:100) {
out <- kNearestNeigboors(x = x1, k = k1, s = s1)
res[i] <-  s1[out]
}
res
kNearestNeigboors(x = x1, k = k1, s = s1)
x = x1
k = k1
s = s1
#Distance to data-point
x_dist <- sqrt((s - x)^2)
#Weights assigned to k-neighbors
s_wgt  <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
order(x_dist)[1:k]
x1 <- 50
s1 <- c(30, 20, 10, 70, 14, 45, 45, 72, 86, 90, 51, 47, 48, 48, 21, 1, 34)
k1 <- 5
#Distance to data-point
x_dist <- sqrt((s - x)^2)
#Weights assigned to k-neighbors
s_wgt  <- sapply(1:k, function(y) (1/y)/(sum(1/(1:k))))
order(x_dist)[1:k]
s1[order(x_dist)[1:k]]
#Sampled value
x_new <- sample(order(x_dist)[1:k], size = 1, replace = TRUE, prob = s_wgt)
x_new
install.packages("roxygen2")
library(hydrosystems)
git status
library(hydrosystems)
knitr::opts_chunk$set(
collapse = TRUE,
comment = "#>",
fig.path = "README-"
)
unlink('README_cache', recursive = TRUE)
